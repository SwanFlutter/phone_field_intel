# Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Validation Ø®ÙˆØ¯Ú©Ø§Ø± Phone Field Intel

Ø§ÛŒÙ† Ø±Ø§Ù‡Ù†Ù…Ø§ ØªÙˆØ¶ÛŒØ­ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯ Ú©Ù‡ Ú†Ø·ÙˆØ± Ø§Ø² Ø³ÛŒØ³ØªÙ… validation Ø®ÙˆØ¯Ú©Ø§Ø± Ù¾Ú©ÛŒØ¬ `phone_field_intel` Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.

## ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯

### ğŸš€ Validation Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ø±Ø§ÛŒ Ù‡Ù…Ù‡ Ú©Ø´ÙˆØ±Ù‡Ø§
- Ø³ÛŒØ³ØªÙ… validation Ù‡ÙˆØ´Ù…Ù†Ø¯ Ú©Ù‡ Ù‚ÙˆØ§Ù†ÛŒÙ† Ù…Ø®ØµÙˆØµ Ù‡Ø± Ú©Ø´ÙˆØ± Ø±Ø§ Ø§Ø¹Ù…Ø§Ù„ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
- Ù†ÛŒØ§Ø²ÛŒ Ø¨Ù‡ Ù†ÙˆØ´ØªÙ† validation Ø³ÙØ§Ø±Ø´ÛŒ Ù†ÛŒØ³Øª
- Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø®Ø·Ø§ÛŒ Ù…Ø­Ù„ÛŒâ€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯Ù‡

### ğŸ”§ ÙÛŒÙ„ØªØ± Ú©Ø´ÙˆØ±Ù‡Ø§
- Ø§Ù…Ú©Ø§Ù† Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† Ú©Ø´ÙˆØ±Ù‡Ø§ÛŒ Ù‚Ø§Ø¨Ù„ Ø§Ù†ØªØ®Ø§Ø¨
- Ù…ÙÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù†â€ŒÙ‡Ø§ÛŒÛŒ Ú©Ù‡ ÙÙ‚Ø· Ø¯Ø± Ù…Ù†Ø§Ø·Ù‚ Ø®Ø§Øµ ÙØ¹Ø§Ù„ÛŒØª Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯

### ğŸŒ Ù‚ÙˆØ§Ù†ÛŒÙ† Ù…Ø®ØµÙˆØµ Ú©Ø´ÙˆØ±Ù‡Ø§
- Ø§ÛŒØ±Ø§Ù†: Ø´Ù…Ø§Ø±Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„ Ø¨Ø§ÛŒØ¯ Ø¨Ø§ 9 Ø´Ø±ÙˆØ¹ Ø´ÙˆØ¯
- Ø¢Ù…Ø±ÛŒÚ©Ø§/Ú©Ø§Ù†Ø§Ø¯Ø§: Ù†Ø¨Ø§ÛŒØ¯ Ø¨Ø§ 0 ÛŒØ§ 1 Ø´Ø±ÙˆØ¹ Ø´ÙˆØ¯
- Ø§Ù†Ú¯Ù„ÛŒØ³: Ø¯Ø± ÙØ±Ù…Øª Ø¨ÛŒÙ†â€ŒØ§Ù„Ù…Ù„Ù„ÛŒ Ù†Ø¨Ø§ÛŒØ¯ Ø¨Ø§ 0 Ø´Ø±ÙˆØ¹ Ø´ÙˆØ¯
- Ø¢Ù„Ù…Ø§Ù†: Ø¯Ø± ÙØ±Ù…Øª Ø¨ÛŒÙ†â€ŒØ§Ù„Ù…Ù„Ù„ÛŒ Ù†Ø¨Ø§ÛŒØ¯ Ø¨Ø§ 0 Ø´Ø±ÙˆØ¹ Ø´ÙˆØ¯
- Ù‡Ù†Ø¯: Ø´Ù…Ø§Ø±Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„ Ø¨Ø§ÛŒØ¯ Ø¨Ø§ 6ØŒ 7ØŒ 8 ÛŒØ§ 9 Ø´Ø±ÙˆØ¹ Ø´ÙˆØ¯
- Ùˆ Ù‚ÙˆØ§Ù†ÛŒÙ† Ù…Ø®ØµÙˆØµ Ø³Ø§ÛŒØ± Ú©Ø´ÙˆØ±Ù‡Ø§...

## Ù†Ø­ÙˆÙ‡ Ø§Ø³ØªÙØ§Ø¯Ù‡

### Ù…Ø«Ø§Ù„ Ø³Ø§Ø¯Ù‡

```dart
IntlPhoneField(
  decoration: InputDecoration(
    labelText: 'Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ†',
    border: OutlineInputBorder(),
  ),
  initialCountryCode: 'IR',
  languageCode: 'fa',
  autovalidateMode: AutovalidateMode.onUserInteraction,
  validator: (phone) {
    if (phone == null || phone.number.isEmpty) {
      return 'Ù„Ø·ÙØ§Ù‹ Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯';
    }
    
    // Ø¨Ø±Ø±Ø³ÛŒ ÙØ±Ù…Øª Ø¹Ø¯Ø¯ÛŒ
    if (!RegExp(r'^[0-9]+$').hasMatch(phone.number)) {
      return 'Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† Ø¨Ø§ÛŒØ¯ ÙÙ‚Ø· Ø´Ø§Ù…Ù„ Ø§Ø¹Ø¯Ø§Ø¯ Ø¨Ø§Ø´Ø¯';
    }
    
    // Ø¨Ø±Ø±Ø³ÛŒ Ø·ÙˆÙ„
    if (!phone.isValidLength()) {
      return 'Ø·ÙˆÙ„ Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª';
    }
    
    // Ø¨Ø±Ø±Ø³ÛŒ ØªØ·Ø¨ÛŒÙ‚ Ú©Ø´ÙˆØ±
    try {
      final detectedCountry = PhoneNumber.getCountry(phone.completeNumber);
      final selectedCountry = countries.firstWhere(
        (c) => c.code == phone.countryISOCode,
      );
      
      if (detectedCountry.code != selectedCountry.code) {
        return 'Ø§ÛŒÙ† Ø´Ù…Ø§Ø±Ù‡ Ù…ØªØ¹Ù„Ù‚ Ø¨Ù‡ Ú©Ø´ÙˆØ± ${detectedCountry.localizedName('fa')} Ø§Ø³Øª';
      }
    } catch (e) {
      // Ø§Ú¯Ø± ØªØ´Ø®ÛŒØµ Ú©Ø´ÙˆØ± Ù†Ø§Ù…ÙˆÙÙ‚ Ø¨ÙˆØ¯ØŒ Ú©Ø¯ Ú©Ø´ÙˆØ± Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†
      final selectedCountry = countries.firstWhere(
        (c) => c.code == phone.countryISOCode,
      );
      final cleanNumber = phone.completeNumber.replaceFirst('+', '');
      final expectedDialCode = selectedCountry.dialCode + selectedCountry.regionCode;
      
      if (!cleanNumber.startsWith(expectedDialCode)) {
        return 'Ø´Ù…Ø§Ø±Ù‡ Ø¨Ø§ÛŒØ¯ Ø¨Ø§ Ú©Ø¯ Ú©Ø´ÙˆØ± ${selectedCountry.localizedName('fa')} Ø´Ø±ÙˆØ¹ Ø´ÙˆØ¯';
      }
    }
    
    return null;
  },
  onChanged: (phone) {
    print('Ø´Ù…Ø§Ø±Ù‡ ØªØºÛŒÛŒØ± Ú©Ø±Ø¯: ${phone.completeNumber}');
  },
  onCountryChanged: (country) {
    print('Ú©Ø´ÙˆØ± Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯: ${country.localizedName('fa')}');
  },
)
```

### Ù…Ø«Ø§Ù„ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ø¨Ø§ Ù…Ø¯ÛŒØ±ÛŒØª State

```dart
class PhoneFieldDemo extends StatefulWidget {
  @override
  _PhoneFieldDemoState createState() => _PhoneFieldDemoState();
}

class _PhoneFieldDemoState extends State<PhoneFieldDemo> {
  Country? _selectedCountry;
  PhoneNumber? _phoneNumber;

  String? _validatePhoneNumber(PhoneNumber? phone) {
    if (phone == null || phone.number.isEmpty) {
      return 'Ù„Ø·ÙØ§Ù‹ Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯';
    }

    // Ø¨Ø±Ø±Ø³ÛŒ ÙØ±Ù…Øª Ø¹Ø¯Ø¯ÛŒ
    if (!RegExp(r'^[0-9]+$').hasMatch(phone.number)) {
      return 'Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† Ø¨Ø§ÛŒØ¯ ÙÙ‚Ø· Ø´Ø§Ù…Ù„ Ø§Ø¹Ø¯Ø§Ø¯ Ø¨Ø§Ø´Ø¯';
    }

    // Ø¨Ø±Ø±Ø³ÛŒ Ø·ÙˆÙ„
    if (!phone.isValidLength()) {
      return 'Ø·ÙˆÙ„ Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† Ø¨Ø§ÛŒØ¯ Ø¨ÛŒÙ† ${_selectedCountry?.minLength ?? 0} ØªØ§ ${_selectedCountry?.maxLength ?? 0} Ø±Ù‚Ù… Ø¨Ø§Ø´Ø¯';
    }

    // Ø¨Ø±Ø±Ø³ÛŒ ØªØ·Ø¨ÛŒÙ‚ Ú©Ø´ÙˆØ±
    if (_selectedCountry != null) {
      try {
        final detectedCountry = PhoneNumber.getCountry(phone.completeNumber);
        
        if (detectedCountry.code != _selectedCountry!.code) {
          return 'Ø§ÛŒÙ† Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† Ù…ØªØ¹Ù„Ù‚ Ø¨Ù‡ Ú©Ø´ÙˆØ± ${detectedCountry.localizedName('fa')} Ø§Ø³Øª. Ù„Ø·ÙØ§Ù‹ Ú©Ø´ÙˆØ± Ø±Ø§ ØªØºÛŒÛŒØ± Ø¯Ù‡ÛŒØ¯ ÛŒØ§ Ø´Ù…Ø§Ø±Ù‡ ØµØ­ÛŒØ­ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.';
        }
      } catch (e) {
        final cleanNumber = phone.completeNumber.replaceFirst('+', '');
        final expectedDialCode = _selectedCountry!.dialCode + _selectedCountry!.regionCode;
        
        if (!cleanNumber.startsWith(expectedDialCode)) {
          return 'Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† Ø¨Ø§ÛŒØ¯ Ø¨Ø§ Ú©Ø¯ Ú©Ø´ÙˆØ± ${_selectedCountry!.localizedName('fa')} Ø´Ø±ÙˆØ¹ Ø´ÙˆØ¯';
        }
      }
    }

    return null;
  }

  @override
  Widget build(BuildContext context) {
    return IntlPhoneField(
      decoration: InputDecoration(
        labelText: 'Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ†',
        border: OutlineInputBorder(),
      ),
      initialCountryCode: 'IR',
      languageCode: 'fa',
      autovalidateMode: AutovalidateMode.onUserInteraction,
      validator: _validatePhoneNumber,
      onChanged: (phone) {
        setState(() {
          _phoneNumber = phone;
        });
      },
      onCountryChanged: (country) {
        setState(() {
          _selectedCountry = country;
        });
      },
    );
  }
}
```

## Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø®Ø·Ø§

### Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ
- `Ù„Ø·ÙØ§Ù‹ Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯` - Ø´Ù…Ø§Ø±Ù‡ Ø®Ø§Ù„ÛŒ Ø§Ø³Øª
- `Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† Ø¨Ø§ÛŒØ¯ ÙÙ‚Ø· Ø´Ø§Ù…Ù„ Ø§Ø¹Ø¯Ø§Ø¯ Ø¨Ø§Ø´Ø¯` - Ú©Ø§Ø±Ø§Ú©ØªØ± ØºÛŒØ±Ù…Ø¬Ø§Ø²
- `Ø·ÙˆÙ„ Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª` - Ø·ÙˆÙ„ Ø®Ø§Ø±Ø¬ Ø§Ø² Ù…Ø­Ø¯ÙˆØ¯Ù‡
- `Ø§ÛŒÙ† Ø´Ù…Ø§Ø±Ù‡ Ù…ØªØ¹Ù„Ù‚ Ø¨Ù‡ Ú©Ø´ÙˆØ± [Ù†Ø§Ù… Ú©Ø´ÙˆØ±] Ø§Ø³Øª` - Ø´Ù…Ø§Ø±Ù‡ Ù…ØªØ¹Ù„Ù‚ Ø¨Ù‡ Ú©Ø´ÙˆØ± Ø¯ÛŒÚ¯Ø±ÛŒ Ø§Ø³Øª
- `Ø´Ù…Ø§Ø±Ù‡ Ø¨Ø§ÛŒØ¯ Ø¨Ø§ Ú©Ø¯ Ú©Ø´ÙˆØ± [Ù†Ø§Ù… Ú©Ø´ÙˆØ±] Ø´Ø±ÙˆØ¹ Ø´ÙˆØ¯` - Ú©Ø¯ Ú©Ø´ÙˆØ± Ø§Ø´ØªØ¨Ø§Ù‡

### Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ
- `Please enter a phone number` - Ø´Ù…Ø§Ø±Ù‡ Ø®Ø§Ù„ÛŒ Ø§Ø³Øª
- `Phone number should only contain digits` - Ú©Ø§Ø±Ø§Ú©ØªØ± ØºÛŒØ±Ù…Ø¬Ø§Ø²
- `Invalid phone number length` - Ø·ÙˆÙ„ Ø®Ø§Ø±Ø¬ Ø§Ø² Ù…Ø­Ø¯ÙˆØ¯Ù‡
- `This number belongs to [Country Name]` - Ø´Ù…Ø§Ø±Ù‡ Ù…ØªØ¹Ù„Ù‚ Ø¨Ù‡ Ú©Ø´ÙˆØ± Ø¯ÛŒÚ¯Ø±ÛŒ Ø§Ø³Øª
- `Phone number should start with [Country Name] dial code` - Ú©Ø¯ Ú©Ø´ÙˆØ± Ø§Ø´ØªØ¨Ø§Ù‡

## ØªØ³Øª Validation

Ø¨Ø±Ø§ÛŒ ØªØ³Øª validation Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø² ÙØ§ÛŒÙ„ ØªØ³Øª Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯:

```bash
flutter test test/phone_validation_test.dart
```

## Ù†Ú©Ø§Øª Ù…Ù‡Ù…

1. **Validation Ø®ÙˆØ¯Ú©Ø§Ø±**: Ø¨Ø§ ØªÙ†Ø¸ÛŒÙ… `autovalidateMode` Ø±ÙˆÛŒ `AutovalidateMode.onUserInteraction`ØŒ validation Ø¨Ù‡ ØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ø§Ø¬Ø±Ø§ Ù…ÛŒâ€ŒØ´ÙˆØ¯.

2. **Ù…Ø¯ÛŒØ±ÛŒØª Ø®Ø·Ø§**: Ù‡Ù…ÛŒØ´Ù‡ Ø®Ø·Ø§Ù‡Ø§ Ø±Ø§ Ø¨Ù‡ ØµÙˆØ±Øª graceful handle Ú©Ù†ÛŒØ¯ ØªØ§ ØªØ¬Ø±Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø¨Ù‡ØªØ±ÛŒ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯.

3. **Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ù…Ø­Ù„ÛŒ**: Ø§Ø² `localizedName` Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ù†Ø§Ù… Ú©Ø´ÙˆØ±Ù‡Ø§ Ø¨Ù‡ Ø²Ø¨Ø§Ù† Ù…Ø­Ù„ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.

4. **Performance**: Validation Ø¯Ø± `onChanged` Ø§Ø¬Ø±Ø§ Ù…ÛŒâ€ŒØ´ÙˆØ¯ØŒ Ù¾Ø³ Ø³Ø¹ÛŒ Ú©Ù†ÛŒØ¯ Ú©Ø¯ validation Ø±Ø§ Ø¨Ù‡ÛŒÙ†Ù‡ Ú©Ù†ÛŒØ¯.

## Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø¯ÛŒ

### Validation Ø¨Ø±Ø§ÛŒ Ø§ÛŒØ±Ø§Ù†
```dart
validator: (phone) {
  if (phone?.countryISOCode == 'IR') {
    // Ø¨Ø±Ø±Ø³ÛŒ Ø´Ù…Ø§Ø±Ù‡ Ø§ÛŒØ±Ø§Ù†
    if (phone!.number.length != 10) {
      return 'Ø´Ù…Ø§Ø±Ù‡ Ø§ÛŒØ±Ø§Ù† Ø¨Ø§ÛŒØ¯ 10 Ø±Ù‚Ù… Ø¨Ø§Ø´Ø¯';
    }
    if (!phone.number.startsWith('9')) {
      return 'Ø´Ù…Ø§Ø±Ù‡ Ø§ÛŒØ±Ø§Ù† Ø¨Ø§ÛŒØ¯ Ø¨Ø§ 9 Ø´Ø±ÙˆØ¹ Ø´ÙˆØ¯';
    }
  }
  return null;
}
```

### Validation Ø¨Ø±Ø§ÛŒ Ø¢Ù…Ø±ÛŒÚ©Ø§
```dart
validator: (phone) {
  if (phone?.countryISOCode == 'US') {
    // Ø¨Ø±Ø±Ø³ÛŒ Ø´Ù…Ø§Ø±Ù‡ Ø¢Ù…Ø±ÛŒÚ©Ø§
    if (phone!.number.length != 10) {
      return 'Ø´Ù…Ø§Ø±Ù‡ Ø¢Ù…Ø±ÛŒÚ©Ø§ Ø¨Ø§ÛŒØ¯ 10 Ø±Ù‚Ù… Ø¨Ø§Ø´Ø¯';
    }
  }
  return null;
}
```

Ø§ÛŒÙ† Ø±Ø§Ù‡Ù†Ù…Ø§ Ø¨Ù‡ Ø´Ù…Ø§ Ú©Ù…Ú© Ù…ÛŒâ€ŒÚ©Ù†Ø¯ ØªØ§ validation Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ùˆ Ú©Ø§Ø±Ø¨Ø±Ø¯ÛŒ Ø¨Ø±Ø§ÛŒ Ø´Ù…Ø§Ø±Ù‡â€ŒÙ‡Ø§ÛŒ ØªÙ„ÙÙ† Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ú©Ù†ÛŒØ¯. 